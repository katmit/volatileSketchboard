@{
    ViewBag.Title = "Volatile Sketchboard";
}

<body>
    <div id="roomManager" class="flex-container" style="height:100%;min-width:1100px;">
        <div style="float:left;width:50%;padding-top:25%;">
            <div style="padding-left:25%;">
                <table>
                    <tr>
                        <td>
                            <label for="roomID">Room ID:</label>
                            <input type="text" value="" id="roomID" style="height:35px;">
                        </td>
                        <td>
                            <button id="joinRoomButton" class="toolbarButton" style="padding: 5px 5px;width:50px;height:35px;">Join</button>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div style="float: right; width: 50%; padding-top: 25%;">
            <div style="        width: 100%;
        padding-left: 25%
">
                <button style="width:50%;" id="createRoomButton" class="toolbarButton">Create New Room</button>
            </div>
        </div>
    </div>
</body>

@section scripts {

    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        // Reference the auto-generated proxy for the hub.
        var hub = $.connection.drawingHub;

        $.connection.hub.start().done(function () {
            $('#createRoomButton').click(function () {
                hub.server.createRoom().done(function (result){
                    var url = '@Url.Action("Draw", "Home", new { id = "__param__" })';
                    window.location.href = url.replace('__param__', encodeURIComponent(result));
                });
            });
            $('#joinRoomButton').click(function () {
                var givenRoomID = $('#roomID').val();
                hub.server.roomExists(givenRoomID).done(function (result) {
                    if (result == true) {
                        var url = '@Url.Action("Draw", "Home", new { id = "__param__" })';
                        window.location.href = url.replace('__param__', encodeURIComponent(givenRoomID));
                    } else {
                        alert("Not a valid, in-session room ID.");
                    }
                });
            });
        });



    </script>

}
